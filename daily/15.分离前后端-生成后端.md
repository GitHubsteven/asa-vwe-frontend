##### 当前
当前：webpack+vue+express，前后端是一起的，通过webpack来打包，通过下面的脚本可以很容易的指导：
```
"buildDev": "DEL /F /Q dist  & webpack --mode development --config webpack.server.config.js & webpack --mode development --config webpack.dev.config.js",
```
在打包的时候，webpack将前端和服务器分割开了，最终的结合方式是/dist/index.html
通过下面的代码我们可以知道：
```
app.get("/", (req, res) => {
  res.sendFile(path.join(__dirname, 'index.html'));
});
```
通过服务器的方位端口后 http://ip:port/
express服务器会将webpack打包生成后的index.html发送到服务器，后面所有的操作都是通过express来操作，然后在部署服务器上的时候，重复下这个流程就可以了，理论上来说，这其实和spring boot + thymeleaf并没有什么区别。
虽然可以实现需求，但是总的来说是很奇怪的。所以，打算将项目分开来，前端和后端分割开来，分开的项目参考一：
- 前端：[asa-vwe-fronted-2.0](https://github.com/GitHubsteven/asa-vwe-frontend-2.0)
- 后端：[asa-vwe-express](https://github.com/GitHubsteven/asa-vwe-express)
- 不分离：[asa-vwe-frontend](https://github.com/GitHubsteven/asa-vwe-frontend)

方式二：参靠不同的分支
- 前端: asa-vwe-vue
- 后端: asa-vwe-express
- 不分离： master|master-mongodb-2| master-fronted-backend



根据当前的项目来删除部分的代码可以拆分前后端。
生成前端参考文档[14.分离前后端-生成前端.md](../14.分离前后端-生成前端.md)


##### 生成后端工程
生成后端只需要保留express相关，其他的不需要
1.删除/src/ex-router，/src/server，/src/models外的其他的，目录如下：
```
daily
src
    ex-router
    models
    server
        server-dev.js
        server-prod.js
.babelrc
.eslintrc.js
.gitignore
package.json
package-lock.json
readme.md
webpack.server.config.js
```
ex-router 和models下的文件不需要改变
2. 修改server-dev.js的内容如下，删除webpack相关的，最后代码如下：
```
import express from 'express'

let cookieParser = require('cookie-parser');
import router from '../ex-router/ex-router';
import userRouter from '../ex-router/user-router';

//链接数据库
let bodyParser = require('body-parser');
let cors = require('cors');
let mongoose = require('mongoose');
let session = require('express-session');

const app = express();
//服务器连接数据库
let DB_URL = "mongodb://localhost:27017/blogs";
mongoose.connect(DB_URL, {useNewUrlParser: true, useCreateIndex: true})
  .then(() => {
        console.log("connect successfully!")
    }, (err) => {
        console.log('error when connect to mongo db!' + err)
    }
  );

mongoose.set('useFindAndModify', false);

//表示数据格式以json方式来传递？
app.use(bodyParser.urlencoded({extended: false}));
app.use(bodyParser.json());
app.use(cors());

// app.use(logger('dev'));
app.use(cookieParser());
// 使用 session 中间件
app.use(session({
    secret: 'secret', // 对session id 相关的cookie 进行签名
    resave: true,
    saveUninitialized: false, // 是否保存未初始化的会话
    cookie: {
        maxAge: 1000 * 60 * 3, // 设置 session 的有效时间，单位毫秒
    },
}));
app.use(router);
app.use(userRouter);

app.get("/", (req, res) => {
    return "this is express api";
});

const PORT = process.env.PORT || 9000;
app.listen(PORT, (err) => {
    if (err) {
        console.log(err);
        return;
    }
    console.log(`App listening to ${PORT}....`);
    console.log('Press Ctrl+C to quit.')
});
```

修改package.json的script如下：
```
  "scripts": {
    "buildDev": "DEL /F /Q dist  & webpack --mode development --config webpack.server.config.js",
    "buildProd": "DEL /F /Q dist & webpack --mode production --config webpack.server.config.js",
    "buildDevLinux": "rm -rf dist  & webpack --mode development --config webpack.server.config.js",
    "buildProdLinux": "rm -rf dist & webpack --mode production --config webpack.server.config.js ",
    "start": "node ./dist/server.js",
    "debug": "set DEBUG=express:* & node ./dist/server.js"
  }
```
让后就可以打包运行了。执行脚本
```
npm buildDev
npm start
```
通过postman测试，发现运行正常。
其实webpack在这里并不是必须的，我们可以直接运行node server-xxx.js或者通过pm2来运行，在这里只是为了避免和原项目太大的改动。